"use strict";(self.webpackChunkmypath=self.webpackChunkmypath||[]).push([[563],{563:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});var s=n(43),a=n(579);function c(){return(0,a.jsx)("div",{className:"loader-parent",children:(0,a.jsx)("div",{className:"loader"})})}var l=n(184),o=n(224);function i(){const[e,t]=(0,s.useState)(null),[n,i]=(0,s.useState)(null),[r,d]=(0,s.useState)([]),[h,m]=(0,s.useState)(!1),[u,p]=(0,s.useState)(0),[g,x]=(0,s.useState)(0),[j,f]=(0,s.useState)(0),v=(0,s.useRef)(null),N=(0,s.useRef)(null),[y,w]=(0,s.useState)(!0),[b,k]=(0,s.useState)(0);function I(e,t){if(!e||!t||!e.lat||!t.lng)return;const n=e=>e*(Math.PI/180),s=n(e.lat),a=n(e.lng),c=n(t.lat),l=c-s,o=n(t.lng)-a,i=Math.sin(l/2)**2+Math.cos(s)*Math.cos(c)*Math.sin(o/2)**2;return 6371*(2*Math.asin(Math.sqrt(i)))*1e3}(0,s.useEffect)((()=>{if(window.google)m(!0);else{const e=document.createElement("script");e.src="https://maps.googleapis.com/maps/api/js?key=".concat("AIzaSyBaQ334LSpDNZXU8flkT1VjGpdj7f3_BZI","&map_ids=YOUR_MAP_ID&v=beta&libraries=marker"),e.async=!0,e.defer=!0,document.head.appendChild(e),e.onload=()=>m(!0)}}),[]),(0,s.useEffect)((()=>{if(!h||!e)return;if(n)return;const t=new window.google.maps.Map(document.getElementById("map"),{center:e,zoom:20,mapId:"YOUR_MAP_ID"});i(t),v.current=new window.google.maps.marker.AdvancedMarkerElement({map:t,position:e,title:"You are here!",id:"user-location-marker"}),N.current=new window.google.maps.Polyline({map:t,path:r,geodesic:!0,strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:2})}),[h,e]);const S=(0,s.useCallback)(((e,t)=>{let n=0;const s=setInterval((()=>{const a=C(e,t,++n/50);v.current&&(v.current.position=a),50===n&&(t.time=Date.now(),n=0,clearInterval(s),d((e=>{const n=e.length;if(n>=2){const s=I(e[n-1],e[n-2]);if(p(s),f(parseInt(I(e[n-1],e[0]))),s<5)return[...e.slice(0,-1),t];x((e=>e+s))}return e.length,[...e,t]})))}),10)}),[u]);(0,s.useEffect)((()=>{N.current&&N.current.setPath(r)}),[r]),(0,s.useEffect)((()=>{if(!h)return;const e=navigator.geolocation.watchPosition((e=>{const n={lat:e.coords.latitude,lng:e.coords.longitude};t((e=>(e?S(e,n):(n.time=Date.now(),d([n])),n)))}),(e=>{alert("Location access denied or not available.")}),{enableHighAccuracy:!0,maximumAge:0});return()=>navigator.geolocation.clearWatch(e)}),[h,S]);const C=(e,t,n)=>({lat:e.lat+(t.lat-e.lat)*n,lng:e.lng+(t.lng-e.lng)*n});return(0,a.jsx)("div",{className:"map-container",children:e?(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{id:"map"}),(0,a.jsxs)("div",{className:"statistics",children:[(0,a.jsx)("div",{className:"stats-child bg-light",children:(0,a.jsxs)("div",{className:"row p-0 m-0",children:[(0,a.jsx)("div",{className:"col-6 col-sm-8 col-lg-3 p-0",children:(0,a.jsx)("div",{className:"h-100 d-inline-flex justify-content-center align-items-center bg-primary w-100 pt-3",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h3",{children:j>1e3?"".concat((j/1e3).toFixed(1),"km"):"".concat(j,"m")}),(0,a.jsx)("p",{children:"Total Displacement"})]})})}),(0,a.jsx)("div",{className:"col-6 col-sm-4 col-lg-3 p-0",children:(0,a.jsx)("div",{className:"h-100 d-inline-flex justify-content-center align-items-center bg-success w-100 pt-3",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h3",{children:g>1e3?"".concat((g/1e3).toFixed(1),"km"):"".concat(parseInt(g),"m")}),(0,a.jsx)("p",{children:"Total Distance"})]})})}),(0,a.jsx)("div",{className:"col-6 col-lg-3 p-0",children:(0,a.jsx)("div",{className:"h-100 d-inline-flex justify-content-center align-items-center bg-warning w-100 pt-3",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h3",{children:u>1e3?"".concat((u/1e3).toFixed(1),"km"):"".concat(parseInt(u),"m")}),(0,a.jsx)("p",{children:"Checkpoint Distance"})]})})}),(0,a.jsx)("div",{className:"col-6 col-lg-3  p-0",children:(0,a.jsx)("div",{className:"h-100 d-inline-flex justify-content-center align-items-center bg-info w-100 pt-3",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h3",{children:r.length-1}),(0,a.jsxs)("p",{children:["Total Checkpoint",r.length>2?"s":""]})]})})})]})}),(0,a.jsx)("div",{className:"stats-toggler container py-2 text-center",children:(0,a.jsxs)("div",{className:"inner",children:[(0,a.jsx)("button",{onClick:()=>{const e=document.getElementsByClassName("stats-child")[0];e?y?(w(!1),e.style.height="0",e.style.overflow="hidden"):(w(!0),e.style.height="max-content",e.style.overflow="auto"):alert("No Div found!")},className:y?"btn btn-primary rounded-0":"btn btn-secondary rounded-0",children:y?(0,a.jsx)(l.uCC,{}):(0,a.jsx)(l.$TP,{})}),(0,a.jsx)("button",{className:"btn btn-secondary rounded-0",onClick:async()=>{try{const t=r.filter((e=>e.time>b)).map((e=>"".concat(e.lat,",").concat(e.lng))).join("|");if(!t)return void console.log("No Data to process!");k(Math.max(...r.map((e=>e.time))));const n="https://roads.googleapis.com/v1/snapToRoads?path=".concat(t,"&interpolate=true&key=").concat("AIzaSyBaQ334LSpDNZXU8flkT1VjGpdj7f3_BZI"),s=await fetch(n);if(!s.ok)throw new Error("API Error: ".concat(s.status," ").concat(s.statusText));const a=await s.json(),c=(null===a||void 0===a?void 0:a.snappedPoints)||[];d([...c.map((e=>{let{location:t}=e;return{lat:t.latitude,lng:t.longitude}})),{lat:e.lat,lng:e.lng}])}catch(t){console.error("Error snapping to road:",t)}},children:(0,a.jsx)(l.Ph,{})}),(0,a.jsx)("button",{className:"btn btn-secondary rounded-0",onClick:()=>{n.panTo(e)},children:(0,a.jsx)(l.hO$,{})}),(0,a.jsx)(o.N_,{className:"btn btn-secondary rounded-0",to:"/PocketGPS/history",children:(0,a.jsx)(l.OKX,{})}),(0,a.jsx)("button",{className:"btn btn-success rounded-0",onClick:()=>{let e=prompt("Enter Rpute Name:");e||(e=Date.now()),alert("Saved: ".concat(e))},children:(0,a.jsx)(l.dIn,{})})]})})]})]}):(0,a.jsx)(c,{})})}}}]);
//# sourceMappingURL=563.4ee962da.chunk.js.map